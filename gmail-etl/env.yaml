# EROS Gmail ETL - Cloud Run Configuration
# Aligned with EROS system requirements

# Project Configuration
PROJECT_ID: of-scheduler-proj
GCP_PROJECT_ID: of-scheduler-proj

# Cloud Run Configuration
CLOUD_RUN_REGION: us-central1
JOB_NAME: eros-gmail-etl-job
CLOUD_RUN_SERVICE_ACCOUNT: gmail-elt-pipeline-sa@of-scheduler-proj.iam.gserviceaccount.com

# Gmail Configuration
TARGET_GMAIL_USER: kyle@erosops.com
GMAIL_SEARCH_QUERY: 'from:no-reply@infloww.com subject:"OF mass message history report is ready for download" newer_than:7d'
SERVICE_ACCOUNT_EMAIL: gmail-elt-pipeline-sa@of-scheduler-proj.iam.gserviceaccount.com

# Secret Manager Configuration
GMAIL_SA_SECRET_NAME: "gmail-etl-sa-key"

# Google Cloud Storage
GCS_RAW_BUCKET: eros-report-files-raw-2025
GCS_PREFIX: gmail_etl/reports

# ============================================
# ðŸ”¥ EROS SYSTEM BIGQUERY CONFIGURATION ðŸ”¥
# ============================================
# BigQuery Configuration - ALIGNED WITH EROS DATAFORM PIPELINE
BQ_DATASET: eros_source  # EROS source dataset for Dataform processing
BQ_TABLE: mass_message_daily_final  # Expected by definitions/messaging/stg/mass_messages.sqlx
BIGQUERY_LOCATION: US

# ============================================
# STATE MANAGEMENT
# ============================================
# State Management - uses EROS state bucket
STATE_BUCKET: eros-data-pipe-state
STATE_OBJECT_PATH: processed_emails.json

# Processing Configuration
LOG_LEVEL: INFO
RESET_STATE: "false"  # Set to "true" to reprocess all messages
MAX_MESSAGES_PER_RUN: "5"  # Conservative for testing

# Scheduler Configuration (for automated runs)
CRON_SCHEDULE: "0 5,17 * * *"  # 5am and 5pm daily
SCHEDULER_REGION: us-central1
SCHEDULER_TIME_ZONE: America/Denver
SCHEDULER_SA: gmail-etl-scheduler-invoker@of-scheduler-proj.iam.gserviceaccount.com

# Monitoring
ENABLE_MONITORING: "true"
ALERT_EMAIL: "kyle@erosops.com"